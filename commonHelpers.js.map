{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function fetchImages(query, currentPage) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const API_KEY = '42359389-3e7836390f428de58440ba614';\n\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: 15,\n  };\n\n  const res = await axios.get(BASE_URL, { params });\n  return res.data;\n}\n","function imageTemplate(hit) {\n  const {\n    largeImageURL,\n    webformatURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = hit;\n\n  return `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n             \n            />\n          </a>\n          <div class=\"thumb-block\">\n            <div class=\"block\">\n              <h2 class=\"tittle\">Likes</h2>\n              <p class=\"amount\">${likes}</p>\n            </div>\n            <div class=\"block\">\n              <h2 class=\"tittle\">Views</h2>\n              <p class=\"amount\">${views}</p>\n            </div>\n            <div class=\"block\">\n              <h2 class=\"tittle\">Comments</h2>\n              <p class=\"amount\">${comments}</p>\n            </div>\n            <div class=\"block\">\n              <h2 class=\"tittle\">Downloads</h2>\n              <p class=\"amount\">${downloads}</p>\n            </div>\n          </div>\n        </li>`;\n}\n\nexport function imagesTemplate(hits) {\n  return hits.map(imageTemplate).join('');\n}\n","import { fetchImages } from './js/pixabay-api.js';\nimport { imagesTemplate } from './js/render-functions.js';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n  formElem: document.querySelector('.js-search'),\n  imagesElem: document.querySelector('.gallery'),\n  loadElem: document.querySelector('.js-loader'),\n  btnLoadMore: document.querySelector('.btn-loader'),\n};\n\nconst refreshPage = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlet query;\nlet page;\nlet maxPage;\n\nrefs.formElem.addEventListener('submit', onFormSubmit);\nrefs.btnLoadMore.addEventListener('click', onLoadMoreClick);\n\nasync function onFormSubmit(e) {\n  e.preventDefault();\n\n  query = e.target.elements.search.value.trim();\n  page = 1;\n\n  if (!query) {\n    showError('Please fill in the form');\n    return;\n  }\n  showLoader();\n\n  try {\n    const data = await fetchImages(query, page);\n    if (data.totalHits === 0) {\n      showError(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      return;\n    }\n    maxPage = Math.ceil(data.totalHits / 15);\n    refs.imagesElem.innerHTML = '';\n    renderImages(data.hits);\n  } catch (err) {\n    showError(err);\n    maxPage = 0;\n    refs.imagesElem.innerHTML = '';\n  }\n\n  refreshPage.refresh();\n  hideLoader();\n  checkVisibleBtnStatus();\n  e.target.reset();\n}\n\nasync function onLoadMoreClick() {\n  page += 1;\n  showLoader();\n  const data = await fetchImages(query, page);\n  renderImages(data.hits);\n  refreshPage.refresh();\n  hideLoader();\n  checkVisibleBtnStatus();\n\n  const height =\n    refs.imagesElem.firstElementChild.getBoundingClientRect().height;\n  scrollBy({\n    behavior: 'smooth',\n    top: height * 2,\n  });\n}\n\nfunction renderImages(hits) {\n  const markup = imagesTemplate(hits);\n  refs.imagesElem.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction showLoadBtn() {\n  refs.btnLoadMore.classList.remove('hidden');\n}\nfunction hideLoadBtn() {\n  refs.btnLoadMore.classList.add('hidden');\n}\n\nfunction showLoader() {\n  refs.loadElem.classList.remove('hidden');\n}\nfunction hideLoader() {\n  refs.loadElem.classList.add('hidden');\n}\nfunction showError(msg) {\n  iziToast.error({\n    title: 'Error',\n    message: msg,\n  });\n}\nfunction checkVisibleBtnStatus() {\n  if (page >= maxPage) {\n    hideLoadBtn();\n    showError(`We're sorry, but you've reached the end of search results.`);\n  } else {\n    showLoadBtn();\n  }\n}\n"],"names":["fetchImages","query","currentPage","BASE_URL","params","axios","imageTemplate","hit","largeImageURL","webformatURL","tags","likes","views","comments","downloads","imagesTemplate","hits","refs","refreshPage","SimpleLightbox","page","maxPage","onFormSubmit","onLoadMoreClick","e","showError","showLoader","data","renderImages","err","hideLoader","checkVisibleBtnStatus","height","markup","showLoadBtn","hideLoadBtn","msg","iziToast"],"mappings":"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"}